"use strict";(self["webpackChunkmenu"]=self["webpackChunkmenu"]||[]).push([[256],{3256:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var l=a(6768);const s=e=>((0,l.Qi)("data-v-7c19c812"),e=e(),(0,l.jt)(),e),n={class:"container"},i={class:"flex-container"},o={class:"info"},u={class:"info"},d={class:"info"},c={class:"material-details"},r=s((()=>(0,l.Lk)("div",{class:"content"},[(0,l.Lk)("span",{class:"title"},"物料明细")],-1)));function m(e,t,a,s,m,h){const p=(0,l.g2)("el-input"),b=(0,l.g2)("el-col"),y=(0,l.g2)("el-table-column"),v=(0,l.g2)("el-input-number"),g=(0,l.g2)("el-option"),N=(0,l.g2)("el-select"),_=(0,l.g2)("el-table"),I=(0,l.g2)("el-button"),k=(0,l.g2)("el-button-group");return(0,l.uX)(),(0,l.CE)("div",n,[(0,l.Lk)("div",i,[(0,l.Lk)("div",o,[(0,l.bF)(p,{modelValue:m.deliveryNum,"onUpdate:modelValue":t[0]||(t[0]=e=>m.deliveryNum=e),style:{"max-width":"400px"},placeholder:"",disabled:""},{prepend:(0,l.k6)((()=>[(0,l.eW)("订单号")])),_:1},8,["modelValue"])]),(0,l.Lk)("div",u,[(0,l.bF)(p,{modelValue:m.customer,"onUpdate:modelValue":t[1]||(t[1]=e=>m.customer=e),style:{"max-width":"400px"},placeholder:"",disabled:""},{prepend:(0,l.k6)((()=>[(0,l.eW)("客户")])),_:1},8,["modelValue"])]),(0,l.Lk)("div",d,[(0,l.bF)(p,{modelValue:m.deliveryStatus,"onUpdate:modelValue":t[2]||(t[2]=e=>m.deliveryStatus=e),style:{"max-width":"400px"},placeholder:"",disabled:""},{prepend:(0,l.k6)((()=>[(0,l.eW)("出库状态")])),_:1},8,["modelValue"])])]),(0,l.Lk)("div",c,[(0,l.bF)(b,{span:24},{default:(0,l.k6)((()=>[r])),_:1})]),(0,l.bF)(_,{data:m.tableData,style:{width:"100%"},onSelectionChange:h.handleSelectionChange,"header-align":"center",border:""},{default:(0,l.k6)((()=>[(0,l.bF)(y,{type:"selection",width:"55"}),(0,l.bF)(y,{prop:"supId",label:"物料名",width:"180"}),(0,l.bF)(y,{prop:"materialType",label:"物料类型",width:"180"}),(0,l.bF)(y,{prop:"expInNum",label:"计划数量",width:"180"}),(0,l.bF)(y,{label:"实际数量",width:"180"},{default:(0,l.k6)((e=>[(0,l.bF)(v,{modelValue:m.tableData[e.$index].actInNum,"onUpdate:modelValue":t=>m.tableData[e.$index].actInNum=t,min:m.data_unchanged[e.$index],max:m.tableData[e.$index].expInNum},null,8,["modelValue","onUpdate:modelValue","min","max"])])),_:1}),(0,l.bF)(y,{label:"出库状态",width:"180"},{default:(0,l.k6)((e=>[(0,l.bF)(N,{modelValue:e.row.status,"onUpdate:modelValue":t=>e.row.status=t},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(m.deliveryStatuses,(e=>((0,l.uX)(),(0,l.Wv)(g,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,l.bF)(y,{prop:"note",label:"备注",width:"180"},{default:(0,l.k6)((e=>[(0,l.bF)(p,{modelValue:e.row.note,"onUpdate:modelValue":t=>e.row.note=t},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["data","onSelectionChange"]),(0,l.bF)(k,{class:"button-group"},{default:(0,l.k6)((()=>[(0,l.bF)(I,{type:"primary",onClick:h.save},{default:(0,l.k6)((()=>[(0,l.eW)("保存")])),_:1},8,["onClick"]),(0,l.bF)(I,{onClick:h.cancel},{default:(0,l.k6)((()=>[(0,l.eW)("取消")])),_:1},8,["onClick"])])),_:1})])}a(4114);var h=a(1620),p={data(){return{deliveryNum:"06192024-1459Biff",customer:"",deliveryStatus:"",tableData:[],data_unchanged:[],selection:[],deliveryStatuses:["未发货","已发货","部分发货","作废"]}},mounted(){this.deliveryNum=this.$route.query.DeliveryNum,this.get_exstore_list()},methods:{increaseQuantity(e){this.items[e].actualQuantity++},async get_exstore_list(){try{let e={listNum:this.deliveryNum},t=await(0,h.hK)(e);t=t.wrapInfoDetails.map((e=>({deliveryNum:t.listNum,deliveryStatus:t.listStatus,customer:t.customer,supId:e.supId,expInNum:e.expInNum,actInNum:e.actInNum,boxes:e.boxes,wrapId:e.wrapId,wrapSize:e.wrapSize,status:e.status,unmodify_actInNum:e.actInNum}))),t=t.map((e=>({...e,actInNum:null===e.actInNum?0:e.actInNum})));for(let l=0;l<t.length;l++)this.data_unchanged.push(t[l].actInNum);console.log("this.data_unchanged",this.data_unchanged);const a={OPEN:"未发货",CLOSED:"已发货",PENDING:"部分发货",DISCARDED:"作废"};console.log(t),t.forEach((e=>{e.status in a&&(e.status=a[e.status])})),this.customer=t[0].customer,this.deliveryStatus=t[0].deliveryStatus,console.log("this.deliveryStatus",this.deliveryStatus),console.log("this.customer",this.customer),this.tableData=t,console.log("TableData"),console.log(this.tableData)}catch(e){console.error(e)}},async save_detail_list(e,t){try{let a={listNum:this.deliveryNum,supID:e,actInNum:t};await(0,h.lm)(a)}catch(a){console.error(a)}},async save_stock_accordingly(e,t){try{let a={listNum:this.deliveryNum,supId:e,previousNum:t};console.log(a),await(0,h.mt)(a)}catch(a){console.error(a)}},handleSelectionChange(e){this.selection=e},decreaseQuantity(e){this.items[e].actualQuantity>1&&this.items[e].actualQuantity--},async save(){for(let e=0;e<this.selection.length;e++)await this.save_detail_list(this.selection[e].supId,this.selection[e].actInNum);for(let e=0;e<this.selection.length;e++)await this.save_stock_accordingly(this.selection[e].supId,null==this.selection[e].unmodify_actInNum?0:this.selection[e].unmodify_actInNum);console.log("保存",this.tableData),this.$router.replace("/move/shipment/ShipmentMain")},cancel(){this.$router.replace("/move/shipment/ShipmentMain"),console.log("取消")}}},b=a(1241);const y=(0,b.A)(p,[["render",m],["__scopeId","data-v-7c19c812"]]);var v=y}}]);
//# sourceMappingURL=256.8e4c3d76.js.map